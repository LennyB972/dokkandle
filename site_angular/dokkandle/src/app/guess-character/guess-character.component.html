<div class="game-container">
  <div class="header">
    <h1>DEVINE LE PERSONNAGE DE DOKKAN BATTLE D'AUJOURD'HUI!</h1>
  </div>
  
  <!-- Écran de chargement -->
  <div class="loading-screen" *ngIf="isLoading">
    <div class="loader"></div>
    <p>Chargement du jeu...</p>
  </div>
  
  <!-- Message d'erreur -->
  <div class="error-message" *ngIf="errorMessage">
    <p>{{ errorMessage }}</p>
    <button (click)="startNewGame()" class="retry-button">Réessayer</button>
  </div>
  
  <!-- Zone principale du jeu -->
  <div class="game-content" *ngIf="!isLoading && !errorMessage">
    <!-- Zone de saisie (déplacée avant les résultats) -->
    <div class="input-area" [ngClass]="{'disabled': isGameOver}">
      <div class="input-container">
        <input 
          #characterInput
          type="text" 
          [(ngModel)]="characterGuess" 
          placeholder="Entrez le nom d'un personnage" 
          (keyup.enter)="submitGuess()"
          (input)="onInput()"
          [disabled]="isGameOver"
        >
        
        <!-- Suggestions d'auto-complétion -->
        <div class="suggestions" *ngIf="showSuggestions">
          <div 
            *ngFor="let character of suggestions" 
            class="suggestion-item"
            (click)="selectSuggestion(character)"
          >
            {{ character.name }}
          </div>
        </div>
      </div>
      
      <div class="buttons-container">
        <button 
          class="guess-btn" 
          (click)="submitGuess()" 
          [disabled]="isGameOver || !characterGuess">
          Deviner
        </button>
        
        <button 
          class="abandon-btn" 
          (click)="giveUp()" 
          [disabled]="isGameOver">
          Abandonner
        </button>
      </div>
    </div>

    <!-- Légende des indices (restructurée pour alignement) -->
    <div class="hints-legend" *ngIf="guesses.length > 0">
      <div class="name-spacer"></div>
      <div class="hints-legend-grid">
        <div class="legend-item">TYPE</div>
        <div class="legend-item">COULEUR</div>
        <div class="legend-item">HP,ATT,DEF</div>
        <div class="legend-item">RARETÉ</div>
        <div class="legend-item">ANNÉE</div>
      </div>
    </div>
    
    <!-- Résultats des tentatives précédentes -->
    <div class="results-container">
      <div *ngIf="guesses.length === 0" class="no-guesses">
        <p>Entrez le nom d'un personnage pour commencer à jouer!</p>
      </div>
      
      <div class="guess-row" *ngFor="let guess of guesses">
        <!-- Nom du personnage sur le côté -->
        <div class="character-name" [ngClass]="{'correct': guess.isCorrect}">
          {{ guess.character.name }}
        </div>
        
        <div class="hints-grid">
          <!-- Type (Super/Extreme) -->
          <div class="hint-box" [ngClass]="{'correct-hint': guess.hints.type, 'incorrect-hint': !guess.hints.type}">
            {{ guess.character.type || '?' }}
          </div>
          
          <!-- Couleur (AGL/TEQ/INT/STR/PHY) -->
          <div class="hint-box" [ngClass]="{'correct-hint': guess.hints.color, 'incorrect-hint': !guess.hints.color}">
            {{ guess.character.color || '?' }}
          </div>
          
          <!-- Statistiques (HP, ATT, DEF) avec flèche -->
          <div class="hint-box" [ngClass]="{
            'correct-hint': guess.hints.stats === 'equal',
            'higher-hint': guess.hints.stats === 'higher',
            'lower-hint': guess.hints.stats === 'lower'
          }">
            <div class="stats-container">
              <span>{{ getFormattedStats(guess.character) }}</span>
              <span class="direction-arrow" *ngIf="guess.hints.stats === 'higher'">↓</span>
              <span class="direction-arrow" *ngIf="guess.hints.stats === 'lower'">↑</span>
            </div>
          </div>
          
          <!-- Rareté -->
          <div class="hint-box" [ngClass]="{'correct-hint': guess.hints.rarity, 'incorrect-hint': !guess.hints.rarity}">
            {{ getCharacterRarity(guess.character) }}
          </div>
          
          <!-- Année de sortie avec flèche directionnelle -->
          <div class="hint-box" [ngClass]="{'correct-hint': guess.hints.releaseYear, 'incorrect-hint': !guess.hints.releaseYear}">
            <div class="stats-container">
              <span>{{ getCharacterReleaseYear(guess.character) }}</span>
              <span class="direction-arrow" *ngIf="!guess.hints.releaseYear">
                {{ getYearDirection(guess.character, targetCharacter) }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Message de fin de jeu -->
    <div class="game-over-message" *ngIf="isGameOver">
      <div *ngIf="guesses[guesses.length-1]?.isCorrect" class="success-message">
        <h2>Bravo ! Vous avez trouvé le personnage en {{ attempts }} essai(s).</h2>
      </div>
      
      <div *ngIf="!guesses[guesses.length-1]?.isCorrect" class="failure-message">
        <h2>Dommage ! Le personnage était: {{ targetCharacter.name }}</h2>
      </div>
      
      <button class="new-game-btn" (click)="resetGame()">Nouvelle partie</button>
    </div>
  </div>
  
  <a routerLink="/" class="back-link">Retour à l'accueil</a>
</div>